<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·ª®ng d·ª•ng h·ªçc t·ª´ m·ªõi</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f0f8ff;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px 0;
        }

        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
        }

        h1, h2 {
            text-align: center;
            color: #0056b3;
        }

        .app-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        input[type="text"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 10px auto 0;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #0056b3;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            background-color: #f9f9f9;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        li > .word-container {
             display: flex;
             align-items: center;
             flex-wrap: wrap;
             margin-bottom: 5px;
        }

        .english-span, .vietnamese-span {
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            display: inline-block;
            margin: 2px;
        }

        .english-span {
            background-color: #007bff;
        }

        .vietnamese-span {
            background-color: #28a745;
        }

        /* --- CSS CHO N√öT PH√ÅT √ÇM V√Ä N√öT X√ìA --- */
        .speak-btn {
            cursor: pointer;
            font-size: 1.2em;
            margin-left: 8px;
            transition: transform 0.2s;
        }
        .speak-btn:hover {
            transform: scale(1.2);
        }

        .delete-btn {
            background-color: #dc3545;
            padding: 5px 10px;
            margin: 0;
        }

        .delete-btn:hover {
            background-color: #c82333;
        }

        #matching-game {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .word-column, .meaning-column {
            display: flex;
            flex-direction: column;
            margin: 5px;
        }

        .word-box, .meaning-box {
            padding: 10px 15px;
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            text-align: center;
            font-weight: 500;
            transition: transform 0.2s;
        }
        .word-box:hover, .meaning-box:hover {
            transform: scale(1.05);
        }

        .word-box {
            background-color: #e7f1ff;
            border-color: #007bff;
            color: #0056b3;
        }

        .meaning-box {
            background-color: #e9f7ea;
            border-color: #28a745;
            color: #155724;
        }

        .selected {
            background-color: #fff3cd;
            border-color: #ffc107 !important;
            font-weight: bold;
        }

        #game-result {
            text-align: center;
            font-weight: bold;
            margin-top: 15px;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>H·ªçc t·ª´ m·ªõi m·ªói ng√†y üá¨üáß-üáªüá≥</h1>
        <div class="app-section">
            <h2>Th√™m t·ª´ m·ªõi</h2>
            <input type="text" id="english-word" placeholder="Nh·∫≠p t·ª´ ti·∫øng Anh">
            <input type="text" id="vietnamese-meaning" placeholder="Nh·∫≠p nghƒ©a ti·∫øng Vi·ªát">
            <button id="add-word-btn">Th√™m t·ª´</button>
        </div>

        <div class="app-section">
            <h2>Danh s√°ch t·ª´ v·ª±ng</h2>
            <ul id="word-list"></ul>
        </div>

        <div class="app-section">
            <h2>Tr√≤ ch∆°i N·ªëi T·ª´</h2>
            <button id="start-game-btn">B·∫Øt ƒë·∫ßu ch∆°i!</button>
            <div id="matching-game"></div>
            <p id="game-result"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const englishWordInput = document.getElementById('english-word');
            const vietnameseMeaningInput = document.getElementById('vietnamese-meaning');
            const addWordBtn = document.getElementById('add-word-btn');
            const wordList = document.getElementById('word-list');
            const startGameBtn = document.getElementById('start-game-btn');
            const matchingGame = document.getElementById('matching-game');
            const gameResult = document.getElementById('game-result');

            let words = JSON.parse(localStorage.getItem('words')) || [];

            const saveWords = () => {
                localStorage.setItem('words', JSON.stringify(words));
            };
            
            //--- H√ÄM M·ªöI: PH√ÅT √ÇM T·ª™ M·ªöI (TEXT-TO-SPEECH) ---
            const speakWord = (wordToSpeak) => {
                // Ki·ªÉm tra tr√¨nh duy·ªát c√≥ h·ªó tr·ª£ API kh√¥ng
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(wordToSpeak);
                    utterance.lang = 'en-US'; // Thi·∫øt l·∫≠p ng√¥n ng·ªØ l√† Ti·∫øng Anh (M·ªπ)
                    window.speechSynthesis.speak(utterance);
                } else {
                    alert('Xin l·ªói, tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ch·ª©c nƒÉng ph√°t √¢m.');
                }
            };

            const displayWords = () => {
                wordList.innerHTML = '';
                if (words.length === 0) {
                    wordList.innerHTML = '<li>Ch∆∞a c√≥ t·ª´ n√†o. H√£y th√™m t·ª´ m·ªõi!</li>';
                    return;
                }
                words.forEach((word, index) => {
                    const li = document.createElement('li');
                    
                    // --- C·∫¨P NH·∫¨T HTML: TH√äM ICON C√ÅI LOA üîä ---
                    li.innerHTML = `
                        <div class="word-container">
                            <span class="english-span">${word.english}</span>
                            <span class="speak-btn" data-word="${word.english}">üîä</span>
                            <span class="vietnamese-span">${word.vietnamese}</span>
                        </div>
                        <button class="delete-btn" data-index="${index}">X√≥a</button>
                    `;
                    wordList.appendChild(li);
                });
            };

            const addWord = () => {
                const english = englishWordInput.value.trim();
                const vietnamese = vietnameseMeaningInput.value.trim();

                if (english && vietnamese) {
                    if (words.some(word => word.english.toLowerCase() === english.toLowerCase())) {
                        alert('T·ª´ n√†y ƒë√£ c√≥ trong danh s√°ch!');
                        return;
                    }
                    words.push({ english, vietnamese });
                    englishWordInput.value = '';
                    vietnameseMeaningInput.value = '';
                    saveWords();
                    displayWords();
                } else {
                    alert('Vui l√≤ng nh·∫≠p c·∫£ t·ª´ ti·∫øng Anh v√† nghƒ©a ti·∫øng Vi·ªát.');
                }
            };

            addWordBtn.addEventListener('click', addWord);

            vietnameseMeaningInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addWord();
                }
            });

            // --- C·∫¨P NH·∫¨T EVENT LISTENER ƒê·ªÇ X·ª¨ L√ù C·∫¢ N√öT PH√ÅT √ÇM ---
            wordList.addEventListener('click', (e) => {
                // N·∫øu nh·∫•n v√†o n√∫t ph√°t √¢m
                if (e.target.classList.contains('speak-btn')) {
                    const wordToSpeak = e.target.getAttribute('data-word');
                    speakWord(wordToSpeak);
                }
                // N·∫øu nh·∫•n v√†o n√∫t x√≥a
                else if (e.target.classList.contains('delete-btn')) {
                    const index = e.target.getAttribute('data-index');
                    if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·ª´ n√†y?')) {
                        words.splice(index, 1);
                        saveWords();
                        displayWords();
                    }
                }
            });

            // --- Logic tr√≤ ch∆°i (kh√¥ng thay ƒë·ªïi) ---
            startGameBtn.addEventListener('click', () => {
                if (words.length < 3) {
                    gameResult.textContent = 'B·∫°n c·∫ßn √≠t nh·∫•t 3 t·ª´ ƒë·ªÉ b·∫Øt ƒë·∫ßu tr√≤ ch∆°i.';
                    return;
                }
                gameResult.textContent = '';
                matchingGame.innerHTML = '';

                const gameWords = [...words].sort(() => 0.5 - Math.random()).slice(0, 5);
                const englishWords = gameWords.map(word => word.english);
                const vietnameseMeanings = gameWords.map(word => word.vietnamese).sort(() => 0.5 - Math.random());

                const englishContainer = document.createElement('div');
                englishContainer.className = 'word-column';
                const vietnameseContainer = document.createElement('div');
                vietnameseContainer.className = 'meaning-column';

                englishWords.forEach(word => {
                    const div = document.createElement('div');
                    div.textContent = word;
                    div.classList.add('word-box');
                    div.dataset.word = word;
                    englishContainer.appendChild(div);
                });

                vietnameseMeanings.forEach(meaning => {
                    const div = document.createElement('div');
                    div.textContent = meaning;
                    div.classList.add('meaning-box');
                    div.dataset.meaning = meaning;
                    vietnameseContainer.appendChild(div);
                });

                matchingGame.appendChild(englishContainer);
                matchingGame.appendChild(vietnameseContainer);

                let selectedWord = null;
                let selectedMeaning = null;
                let correctPairs = 0;

                matchingGame.addEventListener('click', (e) => {
                    const target = e.target;
                    if (target.style.visibility === 'hidden' || !(target.classList.contains('word-box') || target.classList.contains('meaning-box'))) return;

                    if (target.classList.contains('word-box')) {
                        if (selectedWord) selectedWord.classList.remove('selected');
                        selectedWord = target;
                        selectedWord.classList.add('selected');
                    } else if (target.classList.contains('meaning-box')) {
                        if (selectedMeaning) selectedMeaning.classList.remove('selected');
                        selectedMeaning = target;
                        selectedMeaning.classList.add('selected');
                    }

                    if (selectedWord && selectedMeaning) {
                        const originalWordObject = words.find(w => w.english === selectedWord.dataset.word);
                        if (originalWordObject && originalWordObject.vietnamese === selectedMeaning.dataset.meaning) {
                            gameResult.textContent = 'Ch√≠nh x√°c!';
                            gameResult.style.color = 'green';
                            selectedWord.style.visibility = 'hidden';
                            selectedMeaning.style.visibility = 'hidden';
                            correctPairs++;
                        } else {
                            gameResult.textContent = 'Sai r·ªìi, th·ª≠ l·∫°i nh√©!';
                            gameResult.style.color = 'red';
                        }
                        setTimeout(() => {
                            if(selectedWord) selectedWord.classList.remove('selected');
                            if(selectedMeaning) selectedMeaning.classList.remove('selected');
                            selectedWord = null;
                            selectedMeaning = null;
                        }, 200);
                        if (correctPairs === gameWords.length) {
                            gameResult.textContent = 'üéâ Ch√∫c m·ª´ng b·∫°n ƒë√£ ho√†n th√†nh! üéâ';
                            gameResult.style.color = '#0056b3';
                        }
                    }
                });
            });

            displayWords();
        });
    </script>
</body>
</html>